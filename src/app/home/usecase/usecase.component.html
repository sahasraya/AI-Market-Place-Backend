<div class="store-container">
    <!-- Header Section -->
    <div class="header-section">
        <h1 class="mainheading">
            Use Cases Management
        </h1>
        <button class="createnewbtn" (click)="openCreatePopup()">
            <span class="material-icons">add</span>
            Add Use Case
        </button>
    </div>

    <!-- Use Cases Table -->
    <div class="table-container">
        <table class="stores-table">
            <thead>
                <tr>
                    <th>Use Case Name</th>
                    <th>Created Date</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let usecase of usecases" class="table-row">
                    <td class="store-name">
                        {{ usecase.usecaseName }}
                    </td>
                    <td>{{ usecase.createdDate | date: 'MMM dd, yyyy' }}</td>

                    <td>
                        <div class="action-buttons">
                            <button class="action-btn edit" (click)="editUsecase(usecase)" title="Edit">
                                <span class="material-icons">edit</span>
                            </button>
                            <button class="action-btn delete" (click)="deleteUsecase(usecase.usecaseid)" title="Delete">
                                <span class="material-icons">delete</span>
                            </button>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>

        <div *ngIf="usecases.length === 0" class="no-data">
            <span class="material-icons">description</span>
            <p>No use cases found</p>
        </div>
    </div>

    <!-- Create/Update Popup -->
    <div class="overlay" *ngIf="showCreatePopup" (click)="closeCreatePopup()"></div>
    <div class="popup" *ngIf="showCreatePopup">
        <div class="popup-header">
            <h2 class="popup-title">
                <span class="material-icons">{{ isEditMode ? 'edit' : 'add_circle' }}</span>
                {{ isEditMode ? 'Update Use Case' : 'Create New Use Case' }}
            </h2>
            <button class="close-btn" (click)="closeCreatePopup()" aria-label="Close popup">
                <span class="material-icons" aria-hidden="true">close</span>
            </button>
        </div>

        <div class="popup-body">
            <form [formGroup]="usecaseForm" (ngSubmit)="onSubmit()" class="store-form">
                <!-- Use Case Name -->
                <div class="form-group">
                    <label for="usecaseName">
                        <span class="material-icons label-icon">description</span>
                        Use Case Name *
                    </label>
                    <input type="text" id="usecaseName" formControlName="usecaseName"
                        placeholder="Enter use case name (e.g., User Authentication, Payment Processing)"
                        class="form-control"
                        [class.error]="usecaseForm.get('usecaseName')?.invalid && usecaseForm.get('usecaseName')?.touched"
                        [class.success]="usecaseForm.get('usecaseName')?.valid && usecaseForm.get('usecaseName')?.touched">
                    <div class="error-message"
                        *ngIf="usecaseForm.get('usecaseName')?.invalid && usecaseForm.get('usecaseName')?.touched">
                        <span class="material-icons">error</span>
                        <span *ngIf="usecaseForm.get('usecaseName')?.errors?.['required']">Use case name is
                            required</span>
                        <span *ngIf="usecaseForm.get('usecaseName')?.errors?.['minlength']">Use case name must be at
                            least 3 characters</span>
                    </div>
                </div>

                <!-- Form Actions -->
                <div class="form-actions">

                    <button type="submit" class="btn btn-primary" [disabled]="!isFormValid || isSubmitting">
                        <span *ngIf="!isSubmitting" class="btn-content">
                            <span class="material-icons">{{ isEditMode ? 'update' : 'add_circle' }}</span>
                            {{ isEditMode ? 'Update Use Case' : 'Create Use Case' }}
                        </span>
                        <span *ngIf="isSubmitting" class="loading-text">
                            <span class="spinner"></span>
                            {{ isEditMode ? 'Updating...' : 'Creating...' }}
                        </span>
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>